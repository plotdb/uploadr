!function(){uploadr.ext.gcs=function(e){var r=e.files,i=e.progress,u=e.opt,o=e.data;return new Promise(function(n,t){r.length;var a=u.domain||"https://storage.googleapis.com",e=new FormData;return e.append("count",r.length),null!=o&&e.append("data","object"==typeof o?JSON.stringify(o):o),ld$.fetch(u.route,{method:"POST",body:e},{type:"json"}).then(function(o){return Promise.all(r.map(function(n,e){var e=o[e],t=e.signedUrl,r=e.id;return ld$.xhr(t,{method:"PUT",body:n.file,headers:{"Content-Type":n.file.type}},{noDefaultHeaders:!0,progress:function(e){return i({percent:e.percent,item:n})}}).then(function(){return{name:n.file.name,id:r,url:a+"/"+u.bucket+"/"+r}}).catch(function(e){return{name:n.file.name,err:e}})}))}).then(function(e){return n(e)}).catch(function(e){return t(e)})})}}.call(this);
